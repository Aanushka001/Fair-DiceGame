(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[910],{692:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var s=a(7876),l=a(4232),n=a(9099),r=a(399),i=a(7657),c=a(6615);function o(){let{user:e,logout:t}=(0,l.useContext)(r.A),a=(0,n.useRouter)(),[o,d]=(0,l.useState)(10),[u,h]=(0,l.useState)(1e3),[x,m]=(0,l.useState)(null),[g,j]=(0,l.useState)(""),[b,p]=(0,l.useState)(!1);(0,l.useEffect)(()=>{if(e){let e=localStorage.getItem("balance");e&&h(Number(e))}else alert("Please log in first."),a.push("/auth/login")},[e,a]);let N=async()=>{if(!(null==e?void 0:e.token)){alert("Invalid session. Please log in again."),t();return}if(o<=0||o>u){j("Invalid bet amount");return}p(!0),j("");try{let t=await (0,i.z)(e.userId,o,e.token);m(t),h(t.balance),localStorage.setItem("balance",t.balance)}catch(e){var a,s;j((null===(s=e.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.error)||"Error rolling dice")}finally{p(!1)}};return(0,s.jsxs)("div",{className:"game-container",children:[(0,s.jsx)("h1",{className:"game-title",children:"\uD83C\uDFB2 Fair Dice Game"}),e&&(0,s.jsxs)("p",{className:"text-center text-lg text-gray-300",children:["\uD83D\uDC64 ",e.username]}),(0,s.jsxs)("p",{className:"game-balance",children:["\uD83D\uDCB0 Balance: $",u]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-300",children:["Bet Amount",(0,s.jsx)("input",{type:"number",value:o,onChange:e=>d(Number(e.target.value)),className:"game-input",min:"1",max:u})]}),g&&(0,s.jsx)("p",{className:"text-red-500 text-center",children:g}),(0,s.jsx)("button",{onClick:N,disabled:b,className:"game-button",children:b?"Rolling...":"Roll Dice"})]}),x&&(0,s.jsxs)("div",{className:"game-result",children:[(0,s.jsxs)("p",{className:"text-lg",children:["\uD83C\uDFB2 Dice Roll: ",x.rollResult]}),(0,s.jsx)("p",{className:"text-xl ".concat(x.winningAmount>0?"game-win":"game-lose"),children:x.winningAmount>0?"\uD83C\uDF89 You Won: $".concat(x.winningAmount):"\uD83D\uDE1E You Lost: $".concat(Math.abs(x.winningAmount))}),(0,s.jsxs)("p",{className:"text-lg",children:["\uD83D\uDCB0 New Balance: $",u]}),(0,s.jsxs)("p",{className:"text-sm text-gray-400",children:["\uD83D\uDD10 Hash: ",x.hash]})]}),(0,s.jsxs)("div",{className:"mt-6 space-x-4 text-center",children:[(0,s.jsx)("button",{onClick:()=>a.push("/auth/login"),className:"text-blue-500 hover:underline",children:"Go to Login"}),(0,s.jsx)("button",{onClick:()=>a.push("/auth/register"),className:"text-blue-500 hover:underline",children:"Go to Register"}),(0,s.jsx)("button",{onClick:t,className:"text-red-500 hover:underline",children:"Logout"})]}),(0,s.jsx)(c.A,{})]})}},6615:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var s=a(7876),l=a(4232);a(6815);let n=()=>{let[e,t]=(0,l.useState)([]),[a,n]=(0,l.useState)(!0),[r,i]=(0,l.useState)("");return(0,l.useEffect)(()=>{(async()=>{n(!0),i("");let e=localStorage.getItem("token");try{let a=await fetch("".concat("http://localhost:5000","/api/leaderboard"),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!a.ok){let e=await a.text();throw Error("HTTP ".concat(a.status,": ").concat(e))}let s=await a.json();s.success?t(s.leaderboard||[]):i(s.message||"Failed to load leaderboard.")}catch(e){i(e.message||"Error fetching leaderboard.")}finally{n(!1)}})()},[]),(0,s.jsxs)("div",{className:"leaderboard-container",children:[(0,s.jsx)("h2",{children:"Leaderboard"}),r&&(0,s.jsx)("p",{className:"error-text",children:r}),a?(0,s.jsx)("p",{children:"Loading leaderboard..."}):(0,s.jsxs)("table",{className:"leaderboard-table",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Rank"}),(0,s.jsx)("th",{children:"Username"}),(0,s.jsx)("th",{children:"Balance"}),(0,s.jsx)("th",{children:"Wins"}),(0,s.jsx)("th",{children:"Losses"})]})}),(0,s.jsx)("tbody",{children:e.length>0?e.map((e,t)=>(0,s.jsxs)("tr",{children:[(0,s.jsxs)("td",{children:["#",t+1]}),(0,s.jsx)("td",{children:e.username}),(0,s.jsxs)("td",{children:["$",e.balance.toFixed(2)]}),(0,s.jsx)("td",{children:e.totalWins}),(0,s.jsx)("td",{children:e.totalLosses})]},e.username||t)):(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:"5",children:"No leaderboard data available."})})})]})]})}},6815:()=>{},7657:(e,t,a)=>{"use strict";a.d(t,{z:()=>s});let s=async(e,t,a)=>{let s=await fetch("http://localhost:5000/api/game/roll",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({userId:e,betAmount:t})});if(!s.ok)throw Error("Invalid token");return s.json()}},9848:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/game",function(){return a(692)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(9848)),_N_E=e.O()}]);